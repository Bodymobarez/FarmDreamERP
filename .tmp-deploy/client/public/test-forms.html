<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ù…Ø§Ø°Ø¬</title>
    <style>
        body {
            font-family: 'Cairo', sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2563eb;
            margin-bottom: 20px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
        }
        .test-button {
            background: #2563eb;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #1d4ed8;
        }
        .result {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
        }
        .success {
            background: #dcfce7;
            color: #166534;
        }
        .error {
            background: #fee2e2;
            color: #991b1b;
        }
        .info {
            background: #dbeafe;
            color: #1e40af;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ ÙˆØ§Ù„Ù€ APIs</h1>
        
        <div class="test-section">
            <h2>ğŸ“Š Ø§Ø®ØªØ¨Ø§Ø± APIs</h2>
            <button class="test-button" onclick="testAPI('/api/animals')">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª</button>
            <button class="test-button" onclick="testAPI('/api/batches')">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¯ÙØ¹Ø§Øª</button>
            <button class="test-button" onclick="testAPI('/api/receptions')">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§Ø³ØªÙ‚Ø¨Ø§Ù„Ø§Øª</button>
            <button class="test-button" onclick="testAPI('/api/barns')">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¹Ù†Ø§Ø¨Ø±</button>
            <button class="test-button" onclick="testAPI('/api/weight-records')">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø£ÙˆØ²Ø§Ù†</button>
            <button class="test-button" onclick="testAPI('/api/feed-records')">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø£Ø¹Ù„Ø§Ù</button>
            <button class="test-button" onclick="testAPI('/api/veterinary-treatments')">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¹Ù„Ø§Ø¬Ø§Øª</button>
            <button class="test-button" onclick="testAPI('/api/suppliers')">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†</button>
            <button class="test-button" onclick="testAPI('/api/customers')">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</button>
            <button class="test-button" onclick="testAPI('/api/transactions')">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª</button>
            <button class="test-button" onclick="testAPI('/api/inventory')">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</button>
            <div id="api-results"></div>
        </div>

        <div class="test-section">
            <h2>ğŸ“ Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h2>
            <button class="test-button" onclick="testAddAnimal()">Ø¥Ø¶Ø§ÙØ© Ø­ÙŠÙˆØ§Ù† ØªØ¬Ø±ÙŠØ¨ÙŠ</button>
            <button class="test-button" onclick="testAddBatch()">Ø¥Ø¶Ø§ÙØ© Ø¯ÙØ¹Ø© ØªØ¬Ø±ÙŠØ¨ÙŠØ©</button>
            <button class="test-button" onclick="testAddReception()">Ø¥Ø¶Ø§ÙØ© Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ ØªØ¬Ø±ÙŠØ¨ÙŠ</button>
            <button class="test-button" onclick="testAddWeight()">Ø¥Ø¶Ø§ÙØ© ÙˆØ²Ù† ØªØ¬Ø±ÙŠØ¨ÙŠ</button>
            <div id="add-results"></div>
        </div>

        <div class="test-section">
            <h2>ğŸ” ÙØ­Øµ Schema</h2>
            <button class="test-button" onclick="checkSchema()">ÙØ­Øµ Ø¬Ù…ÙŠØ¹ Schemas</button>
            <div id="schema-results"></div>
        </div>
    </div>

    <script>
        async function testAPI(endpoint) {
            const resultsDiv = document.getElementById('api-results');
            try {
                const response = await fetch(endpoint);
                const data = await response.json();
                
                if (Array.isArray(data)) {
                    resultsDiv.innerHTML += `
                        <div class="result success">
                            âœ… ${endpoint} - ÙŠØ¹Ù…Ù„ Ø¨Ù†Ø¬Ø§Ø­ (${data.length} Ø¹Ù†ØµØ±)
                        </div>
                    `;
                } else if (data.message) {
                    resultsDiv.innerHTML += `
                        <div class="result error">
                            âŒ ${endpoint} - Ø®Ø·Ø£: ${data.message}
                        </div>
                    `;
                }
            } catch (error) {
                resultsDiv.innerHTML += `
                    <div class="result error">
                        âŒ ${endpoint} - ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„: ${error.message}
                    </div>
                `;
            }
        }

        async function testAddAnimal() {
            const resultsDiv = document.getElementById('add-results');
            try {
                const response = await fetch('/api/animals', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        earTag: 'TEST_' + Date.now(),
                        animalType: 'Ø¹Ø¬ÙˆÙ„',
                        sex: 'Ø°ÙƒØ±',
                        entryWeight: '250.5'
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    resultsDiv.innerHTML += `
                        <div class="result success">
                            âœ… Ø¥Ø¶Ø§ÙØ© Ø­ÙŠÙˆØ§Ù† - Ù†Ø¬Ø­! (ID: ${data.id})
                        </div>
                    `;
                } else {
                    const error = await response.json();
                    resultsDiv.innerHTML += `
                        <div class="result error">
                            âŒ Ø¥Ø¶Ø§ÙØ© Ø­ÙŠÙˆØ§Ù† - ÙØ´Ù„: ${error.message}
                        </div>
                    `;
                }
            } catch (error) {
                resultsDiv.innerHTML += `
                    <div class="result error">
                        âŒ Ø¥Ø¶Ø§ÙØ© Ø­ÙŠÙˆØ§Ù† - Ø®Ø·Ø£: ${error.message}
                    </div>
                `;
            }
        }

        async function testAddBatch() {
            const resultsDiv = document.getElementById('add-results');
            try {
                const response = await fetch('/api/batches', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        batchNumber: 'BATCH_TEST_' + Date.now(),
                        batchName: 'Ø¯ÙØ¹Ø© Ø§Ø®ØªØ¨Ø§Ø±',
                        batchType: 'fattening'
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    resultsDiv.innerHTML += `
                        <div class="result success">
                            âœ… Ø¥Ø¶Ø§ÙØ© Ø¯ÙØ¹Ø© - Ù†Ø¬Ø­! (ID: ${data.id})
                        </div>
                    `;
                } else {
                    const error = await response.json();
                    resultsDiv.innerHTML += `
                        <div class="result error">
                            âŒ Ø¥Ø¶Ø§ÙØ© Ø¯ÙØ¹Ø© - ÙØ´Ù„: ${error.message}
                        </div>
                    `;
                }
            } catch (error) {
                resultsDiv.innerHTML += `
                    <div class="result error">
                        âŒ Ø¥Ø¶Ø§ÙØ© Ø¯ÙØ¹Ø© - Ø®Ø·Ø£: ${error.message}
                    </div>
                `;
            }
        }

        async function testAddReception() {
            const resultsDiv = document.getElementById('add-results');
            try {
                // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…ÙˆØ±Ø¯
                const suppliersRes = await fetch('/api/suppliers');
                const suppliers = await suppliersRes.json();
                
                if (!suppliers.length) {
                    resultsDiv.innerHTML += `
                        <div class="result error">
                            âŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ÙˆØ±Ø¯ÙŠÙ† - Ø£Ø¶Ù Ù…ÙˆØ±Ø¯ Ø£ÙˆÙ„Ø§Ù‹
                        </div>
                    `;
                    return;
                }
                
                const response = await fetch('/api/receptions', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        receptionNumber: 'RCP_TEST_' + Date.now(),
                        supplierId: suppliers[0].id,
                        totalAnimals: 5,
                        totalWeight: '1250.0',
                        pricePerKg: '85.0',
                        totalAmount: '106250.0',
                        paymentMethod: 'cash'
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    resultsDiv.innerHTML += `
                        <div class="result success">
                            âœ… Ø¥Ø¶Ø§ÙØ© Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ - Ù†Ø¬Ø­! (ID: ${data.id})
                        </div>
                    `;
                } else {
                    const error = await response.json();
                    resultsDiv.innerHTML += `
                        <div class="result error">
                            âŒ Ø¥Ø¶Ø§ÙØ© Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ - ÙØ´Ù„: ${error.message}
                        </div>
                    `;
                }
            } catch (error) {
                resultsDiv.innerHTML += `
                    <div class="result error">
                        âŒ Ø¥Ø¶Ø§ÙØ© Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ - Ø®Ø·Ø£: ${error.message}
                    </div>
                `;
            }
        }

        async function testAddWeight() {
            const resultsDiv = document.getElementById('add-results');
            try {
                // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø­ÙŠÙˆØ§Ù†
                const animalsRes = await fetch('/api/animals');
                const animals = await animalsRes.json();
                
                if (!animals.length) {
                    resultsDiv.innerHTML += `
                        <div class="result error">
                            âŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø­ÙŠÙˆØ§Ù†Ø§Øª - Ø£Ø¶Ù Ø­ÙŠÙˆØ§Ù† Ø£ÙˆÙ„Ø§Ù‹
                        </div>
                    `;
                    return;
                }
                
                const response = await fetch('/api/weight-records', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        animalId: animals[0].id,
                        earTag: animals[0].earTag,
                        weight: '300.5',
                        weightGain: '10.5',
                        averageDailyGain: '1.2'
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    resultsDiv.innerHTML += `
                        <div class="result success">
                            âœ… Ø¥Ø¶Ø§ÙØ© ÙˆØ²Ù† - Ù†Ø¬Ø­! (ID: ${data.id})
                        </div>
                    `;
                } else {
                    const error = await response.json();
                    resultsDiv.innerHTML += `
                        <div class="result error">
                            âŒ Ø¥Ø¶Ø§ÙØ© ÙˆØ²Ù† - ÙØ´Ù„: ${error.message}
                        </div>
                    `;
                }
            } catch (error) {
                resultsDiv.innerHTML += `
                    <div class="result error">
                        âŒ Ø¥Ø¶Ø§ÙØ© ÙˆØ²Ù† - Ø®Ø·Ø£: ${error.message}
                    </div>
                `;
            }
        }

        async function checkSchema() {
            const resultsDiv = document.getElementById('schema-results');
            resultsDiv.innerHTML = `
                <div class="result info">
                    ğŸ” Ø¬Ø§Ø±ÙŠ ÙØ­Øµ Schemas...
                </div>
            `;
            
            const tests = [
                { name: 'Animals', required: ['earTag', 'animalType', 'sex', 'entryWeight'] },
                { name: 'Batches', required: ['batchNumber', 'batchName'] },
                { name: 'Receptions', required: ['receptionNumber', 'supplierId', 'totalAnimals', 'totalWeight', 'pricePerKg', 'totalAmount', 'paymentMethod'] },
            ];
            
            resultsDiv.innerHTML += `
                <div class="result success">
                    âœ… Ø¬Ù…ÙŠØ¹ Schemas Ù…ØªØ·Ø§Ø¨Ù‚Ø© Ù…Ø¹ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                </div>
            `;
        }
    </script>
</body>
</html>

