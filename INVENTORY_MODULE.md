# مديول المخزون والأعلاف - نظام FarmDream ERP

## ✨ الميزات المكتملة

### 1. إدارة المخزون الكاملة
- **تصنيف الأصناف**: أعلاف وأدوية منفصلة
- **تتبع المخزون الفوري**: كمية متاحة، حد إعادة الطلب، تنبيهات مخزون منخفض
- **القيمة الإجمالية**: حساب تلقائي لقيمة المخزون

### 2. نظام الصرف المتقدم
- **صرف للدفعات**: ربط الصرف بدفعة معينة وتحديث تكاليفها تلقائياً
- **صرف للحيوانات الفردية**: تسجيل علاج فردي لحيوان محدد
- **صرف عام**: صرف بدون ربط محدد
- **تتبع كامل**: من صرف؟ متى؟ لمين؟ كم؟

### 3. سجل الحركات التفصيلي
- **كل حركة مسجلة**: إضافة، صرف، تحويل
- **معلومات شاملة**: 
  - رقم الحركة الفريد
  - التاريخ والوقت
  - الصنف والكمية
  - المستفيد (دفعة/حيوان/عنبر)
  - الموظف المسؤول
  - الوصف والملاحظات

### 4. التكامل مع باقي النظام
- **تحديث تلقائي للتكاليف**:
  - صرف علف → يضاف للدفعة كـ `totalFeedCost`
  - صرف دواء → يضاف للدفعة كـ `totalTreatmentCost`
  - علاج فردي → يضاف للحيوان كـ `accumulatedTreatmentCost`
- **ربط مع الموردين**: تتبع من أين اشترينا
- **ربط مع الدفعات والحيوانات**: معرفة التكاليف الحقيقية

## 📊 البيانات التجريبية المتوفرة

### الأعلاف (4 أصناف):
1. **علف بادئ مركز** - 500 كجم متاح
2. **علف نامي** - 750 كجم متاح
3. **علف تسمين** - 150 كجم متاح (مخزون منخفض ⚠️)
4. **برسيم جاف** - 300 كجم متاح

### الأدوية (3 أصناف):
1. **مضاد حيوي - بنسلين** - 50 قرص متاح
2. **فيتامينات AD3E** - 30 عبوة متاحة
3. **مطهر جروح - بيتادين** - 15 عبوة متاحة (مخزون منخفض ⚠️)

### سجل الحركات (3 عمليات):
1. صرف 50 كجم علف بادئ للدفعة B-2025-001
2. صرف 10 أقراص مضاد حيوي لعلاج الحيوان A-001
3. إضافة 500 كجم علف نامي من المورد

## 🚀 كيفية الاستخدام

### صرف من المخزون:
1. افتح صفحة **المخزون**
2. اختر التبويب (أعلاف أو أدوية)
3. اضغط **"صرف"** على الكارت أو **"صرف من المخزون"** في الأعلى
4. املأ التفاصيل:
   - الصنف والكمية
   - الدفعة (اختياري للصرف الجماعي)
   - الحيوان (اختياري للعلاج الفردي)
   - العنبر (اختياري)
   - الوصف والملاحظات
5. اضغط **"تأكيد الصرف"**

### عرض سجل الحركات:
1. في صفحة المخزون
2. اضغط **"سجل الحركات"**
3. شاهد آخر 10 حركات مع كل التفاصيل

### الإحصائيات المتوفرة:
- إجمالي الأصناف
- عدد الأعلاف
- عدد الأدوية
- أصناف المخزون المنخفض (تحذير تلقائي)
- قيمة المخزون الإجمالية

## 🔗 API Endpoints

### Inventory Items:
- `GET /api/inventory` - جلب كل الأصناف
- `GET /api/inventory/:id` - جلب صنف محدد
- `POST /api/inventory` - إضافة صنف جديد
- `PUT /api/inventory/:id` - تعديل صنف
- `DELETE /api/inventory/:id` - حذف صنف

### Inventory Transactions:
- `GET /api/inventory/transactions` - جلب كل الحركات
- `GET /api/inventory/transactions/:id` - جلب حركة محددة
- `POST /api/inventory/dispense` - صرف من المخزون

### Dispense Request Body:
```json
{
  "itemId": "inv-1",
  "quantity": 50,
  "batchId": "batch-1",     // اختياري
  "animalId": "animal-1",   // اختياري
  "penNumber": "عنبر 1",     // اختياري
  "description": "تغذية يومية",
  "notes": "ملاحظات إضافية"
}
```

## 📈 التقارير والتحليلات

المتوفر حالياً:
- ✅ تتبع الصرف حسب الدفعة
- ✅ تتبع الصرف حسب الحيوان
- ✅ تنبيهات المخزون المنخفض
- ✅ حساب قيمة المخزون

قريباً:
- 📊 تقرير استهلاك العلف لكل دفعة
- 📊 تقرير تكاليف العلاج لكل حيوان
- 📊 تحليل معدل الاستهلاك
- 📊 توقعات إعادة الطلب

## 🎯 التحديثات التلقائية

عند صرف من المخزون:
1. **المخزون**: يقل تلقائياً
2. **سجل الحركات**: يُسجل مع كل التفاصيل
3. **تكلفة الدفعة**: تزيد تلقائياً إذا كان الصرف للدفعة
4. **تكلفة الحيوان**: تزيد تلقائياً إذا كان الصرف للحيوان
5. **التنبيهات**: تظهر إذا وصل المخزون لحد إعادة الطلب

## 🔧 التكوين

### حد إعادة الطلب (Reorder Point):
- يمكن ضبطه لكل صنف
- عند الوصول إليه: تنبيه أحمر "مخزون منخفض"
- يظهر زر "إعادة طلب" تلقائياً

### الوحدات المدعومة:
- كجم (للأعلاف)
- قرص، عبوة، لتر (للأدوية)
- أي وحدة مخصصة

## 💡 نصائح الاستخدام

1. **سجل كل صرف فوراً** لمتابعة دقيقة
2. **اربط الصرف بالدفعة** لمعرفة التكاليف الحقيقية
3. **راقب التنبيهات** لتجنب نفاذ المخزون
4. **راجع السجل دورياً** للتحليل

## 🎨 واجهة المستخدم

- **كروت ملونة** لسهولة التمييز
- **تنبيهات بصرية** للمخزون المنخفض
- **إحصائيات فورية** في الأعلى
- **جداول تفاعلية** للسجل
- **حوار صرف ذكي** مع اقتراحات

---

**تم التطوير بواسطة**: نظام FarmDream ERP  
**التاريخ**: يونيو 2025  
**الإصدار**: 1.0
